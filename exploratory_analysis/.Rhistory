# load package for manipulating tibbles
library(tidyverse)
# load package for reading xlsx files
library(readxl)
# read the raw creatinine data
urinary_creatinine_data <- read_excel("../../../../Lee2024Creatinine-Final.xlsx")
head(urinary_creatinine_data)
# read the raw creatinine data
urinary_creatinine_data <- read_excel("../../../../Lee2024Creatinine-Final.xlsx")
head(urinary_creatinine_data)
# read the raw creatinine data
urinary_creatinine_data <- read_excel("../../../../Lee2024Creatinine-Final.xlsx")
creat_data <- urinary_creatinine_data %>% select(`Parikh lab ID`, `URCREA_final`)
head(urinary_creatinine_data)
# read the raw creatinine data
urinary_creatinine_data <- read_excel("../../../../Lee2024Creatinine-Final.xlsx")
creat_data <- urinary_creatinine_data %>% select(`Parikh lab ID`, `URCREA_final`)
head(creat_data)
# read the raw creatinine data
urinary_creatinine_data <- read_excel("../../../../Lee2024Creatinine-Final.xlsx")
creat_data <- urinary_creatinine_data %>% select(`Parikh lab ID`, `URCREA_final`)
%>% rename(PID=`Parikh lab ID`, urcrea=URCREA_final)
# read the raw creatinine data
urinary_creatinine_data <- read_excel("../../../../Lee2024Creatinine-Final.xlsx")
creat_data <- urinary_creatinine_data %>% select(`Parikh lab ID`, `URCREA_final`) %>%
rename(PID=`Parikh lab ID`, urcrea=URCREA_final)
head(creat_data)
# read the raw biomarker data
biomarker_data <- read_excel("../../../../pivoted_raw_data.xlsx")
head(biomarker_data)
nrow(creat_data)
nrow(biomarker_data)
merged_data <- inner_join(creat_data, biomarker_data, by="PID")
# read the raw biomarker data
biomarker_data <- read_excel("../../../../pivoted_raw_data.xlsx")
biomarker_data <- biomarker_data %>% rename(PID = Sample)
head(biomarker_data)
merged_data <- inner_join(creat_data, biomarker_data, by="PID")
head(merged_data)
nrow(merged_data)
merged_data$KIM-1_stand <- merged_data$KIM-1 / merged_data$urcrea
merged_data$KIM-1-stand <- merged_data$KIM-1 / merged_data$urcrea
merged_data$`KIM-1_stand` <- merged_data$`KIM-1` / merged_data$urcrea
merged_data <- merged_data %>%
mutate(KIM-1_stand = KIM-1 / urcrea)
merged_data <- merged_data %>%
mutate(`KIM-1_stand` = `KIM-1` / urcrea)
# read the raw creatinine data
urinary_creatinine_data <- read_excel("../../../../Lee2024Creatinine-Final.xlsx")
creat_data <- urinary_creatinine_data %>% select(`Parikh lab ID`, `URCREA_final`) %>%
rename(PID=`Parikh lab ID`, urcrea=URCREA_final) %>%
mutate(urcrea = as.double(urcrea))
head(creat_data)
# read the raw biomarker data
biomarker_data <- read_excel("../../../../pivoted_raw_data.xlsx")
biomarker_data <- biomarker_data %>% rename(PID = Sample)
head(biomarker_data)
merged_data <- merged_data %>%
mutate(`KIM-1_stand` = `KIM-1` / urcrea)
merged_data <- inner_join(creat_data, biomarker_data, by="PID")
head(merged_data)
merged_data <- merged_data %>%
mutate(`KIM-1_stand` = `KIM-1` / urcrea)
head(merged_data)
merged_data <- merged_data %>%
mutate(`KIM-1_stand` = `KIM-1` / urcrea) %>%
mutate(NGAL_stand = NGAL / urcrea)
head(merged_data)
# read the raw creatinine data
urinary_creatinine_data <- read_excel("../../../../Lee2024Creatinine-Final.xlsx")
creat_data <- urinary_creatinine_data %>% select(`Parikh lab ID`, `URCREA_final`) %>%
rename(sample=`Parikh lab ID`, urcrea=URCREA_final) %>%
mutate(urcrea = as.double(urcrea))
head(creat_data)
# read the raw biomarker data
biomarker_data <- read_excel("../../../../pivoted_raw_data.xlsx")
biomarker_data <- biomarker_data %>% rename(sample = Sample)
head(biomarker_data)
merged_data <- inner_join(creat_data, biomarker_data, by="sample")
head(merged_data)
merged_data <- merged_data %>%
mutate(`KIM-1_stand` = `KIM-1` / urcrea) %>%
mutate(NGAL_stand = NGAL / urcrea)
head(merged_data)
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4)))
head(merged_data)
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*-", "", sample)))
head(merged_data)
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(strsplit(sample, "-", fixed=TRUE)[[1]]))
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(strsplit(sample, "-", fixed=TRUE)[[1]][2]))
head(merged_data)
strsplit("0001-T0", "-", fixed=TRUE)
strsplit("0001-T0", "-", fixed=TRUE)[[1]]
strsplit("0001-T0", "-", fixed=TRUE)[[1]][2]
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(strsplit(sample, "T", fixed=TRUE)[[1]][2]))
head(merged_data)
strsplit("0001-T0", "T", fixed=TRUE)
strsplit("0001-T0", "T", fixed=TRUE)[[1]][2]
strsplit("0001-T1", "T", fixed=TRUE)[[1]][2]
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = strsplit(sample, "T", fixed=TRUE)[[1]][2])
head(merged_data)
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = sub(".*-", "", sample))
head(merged_data)
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = sub(".*T", "", sample))
head(merged_data)
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample)))
head(merged_data)
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
pivot_wider(names_from = collection_time, values_from = c(urcrea, KIM-1))
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
pivot_wider(names_from = collection_time, values_from = c(urcrea, `KIM-1`))
head(merged_data)
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
select(-sample) %>%
pivot_wider(names_from = collection_time, values_from = c(urcrea, `KIM-1`, `MCP-1`, NGAL, `YKL-40`, `KIM-1_stand`, `NGALstand`))
merged_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
pivot_wider(names_from = collection_time, values_from = c(urcrea, `KIM-1`, `MCP-1`, NGAL, `YKL-40`, `KIM-1_stand`, `NGALstand`))
merged_data <- merged_data %>%
mutate(`KIM-1_stand` = `KIM-1` / urcrea) %>%
mutate(NGAL_stand = NGAL / urcrea)
merged_data <- inner_join(creat_data, biomarker_data, by="sample")
head(merged_data)
merged_data <- merged_data %>%
mutate(`KIM-1_stand` = `KIM-1` / urcrea) %>%
mutate(NGAL_stand = NGAL / urcrea)
head(merged_data)
pivoted_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
pivot_wider(names_from = collection_time, values_from = c(urcrea, `KIM-1`, `MCP-1`, NGAL, `YKL-40`, `KIM-1_stand`, `NGALstand`))
pivoted_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
pivot_wider(names_from = collection_time, values_from = c(urcrea, `KIM-1`, `MCP-1`, NGAL, `YKL-40`, `KIM-1_stand`, `NGAL_stand`))
head(merged_data)
pivoted_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
select(-sample) %>%
pivot_wider(names_from = collection_time, values_from = c(urcrea, `KIM-1`, `MCP-1`, NGAL, `YKL-40`, `KIM-1_stand`, `NGAL_stand`))
head(merged_data)
pivoted_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
# select(-sample) %>%
# pivot_wider(names_from = collection_time, values_from = c(urcrea, `KIM-1`, `MCP-1`, NGAL, `YKL-40`, `KIM-1_stand`, `NGAL_stand`))
head(merged_data)
merged_data <- merged_data %>%
mutate(`KIM-1_stand` = `KIM-1` / urcrea) %>%
mutate(NGAL_stand = NGAL / urcrea)
head(merged_data)
pivoted_data <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
select(-sample) %>%
pivot_wider(names_from = collection_time, values_from = c(urcrea, `KIM-1`, `MCP-1`, NGAL, `YKL-40`, `KIM-1_stand`, `NGAL_stand`))
head(pivoted_data)
cleaned_data <- pivoted_data %>%
mutate(delta_KIM1_stand = `KIM-1_stand_1` - `KIM-1_stand_0`) %>%
mutate(delta_NGAL_stand = NGAL_stand_1 - NGAL_stand_0) %>%
select(c(PID, delta_KIM1_stand, delta_NGAL_stand))
print(cleaned_data)
write.csv(cleaned_data, "standardized_KIM1_NGAL.csv", row.names=FALSE)
aki_patient_data <- read.csv("stand_delta_KIM1_NGAL_AKI.csv")
data_by_id <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample)))
head(data_by_id)
aki_patient_data <- read.csv("stand_delta_KIM1_NGAL_AKI.csv")
data_by_id <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
select(-sample) %>%
filter(PID %in% aki_patient_data$PID)
head(data_by_id)
aki_patient_data <- read.csv("stand_delta_KIM1_NGAL_AKI.csv")
data_by_id <- merged_data %>%
mutate(sample = sub("-NC", "", sample)) %>%
mutate(sample = sub("Pre-CPB/", "", sample)) %>%
mutate(PID = as.double(substr(sample, 1, 4))) %>%
mutate(collection_time = as.double(sub(".*T", "", sample))) %>%
select(-sample) %>%
filter(PID %in% aki_patient_data$PID)
write.csv(data_by_id, "raw_data_aki.csv", row.names=FALSE)
